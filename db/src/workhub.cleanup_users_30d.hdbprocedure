PROCEDURE "workhub::cleanup_users_30d" ()
    LANGUAGE SQLSCRIPT
    SQL SECURITY INVOKER
AS
BEGIN

    -- USER_STATUS = 'REQUESTED' 이고 lastRequestedAt 기준 30일 지난 유저는 삭제
    DELETE FROM "WORKHUB_USER"
     WHERE "USER_STATUS" = 'REQUESTED'
       AND "LASTREQUESTEDAT" IS NOT NULL
       AND "LASTREQUESTEDAT" < ADD_DAYS(CURRENT_UTCTIMESTAMP, -30);

END;

